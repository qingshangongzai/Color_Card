# 直方图加载提示计划

## 目标
为直方图组件添加"加载中"提示，提升用户体验，让用户知道直方图正在计算中。

## 设计方案

### 1. 在 BaseHistogram 基类中添加加载状态支持

**修改文件**: `ui/histograms.py`

**添加内容**:
- 添加 `_is_loading` 状态标志
- 添加 `set_loading()` 方法设置加载状态
- 在 `paintEvent()` 中绘制加载提示

**加载提示样式**:
- 位置：直方图区域中央
- 文字："加载中..."
- 背景：半透明深色背景 + 圆角
- 文字颜色：主题高亮色
- 字体：系统默认字体，适当大小

### 2. 修改各直方图组件的 set_image 方法

**LuminanceHistogramWidget**:
- `set_image()` 开始时调用 `set_loading(True)`
- `_on_histogram_ready()` 回调中调用 `set_loading(False)`
- `_on_histogram_error()` 中调用 `set_loading(False)`

**RGBHistogramWidget**:
- `set_image()` 开始时调用 `set_loading(True)`
- `_on_rgb_finished()` 回调中调用 `set_loading(False)`
- `_on_histogram_error()` 中调用 `set_loading(False)`

**HueHistogramWidget**:
- `set_image()` 开始时调用 `set_loading(True)`
- `_on_hue_finished()` 回调中调用 `set_loading(False)`
- `_on_histogram_error()` 中调用 `set_loading(False)`

### 3. 绘制逻辑

在 `BaseHistogram.paintEvent()` 中:
1. 先绘制背景和直方图（如果有数据）
2. 如果 `_is_loading` 为 True，在中央绘制加载提示

加载提示绘制:
- 计算中央位置
- 绘制半透明背景矩形（圆角）
- 绘制"加载中..."文字

## 文件变更清单

### 修改文件
1. `ui/histograms.py`
   - `BaseHistogram` 类：添加加载状态支持和绘制方法
   - `LuminanceHistogramWidget` 类：在适当位置设置加载状态
   - `RGBHistogramWidget` 类：在适当位置设置加载状态
   - `HueHistogramWidget` 类：在适当位置设置加载状态

## UI 设计参考

根据用户提供的截图:
- 白色半透明背景矩形
- 圆角边框
- 蓝色/青色文字"加载中"
- 居中显示

## 验收标准
- [ ] 设置图片后显示"加载中"提示
- [ ] 直方图计算完成后隐藏提示
- [ ] 提示样式美观，符合主题风格
- [ ] 计算出错时也隐藏提示
