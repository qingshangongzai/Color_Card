# 开发规范重构计划

**创建日期**: 2026-02-13  
**目标**: 将现有开发规范拆分为三个独立文档，提高 AI 编程效率和文档可维护性。

---

## 一、背景分析

### 当前问题

| 问题 | 影响 |
|------|------|
| 文档过长（2236行） | AI 无法完整阅读和记忆 |
| 内容混杂 | 核心规则与经验总结混在一起 |
| 定位不清 | 人看的和 AI 看的内容没有区分 |

### 重构目标

```
文档/
├── 开发规范_核心原则.md    # AI 速览版（1-2页）
├── 开发规范.md             # 完整版（给人看）
└── 开发经验总结.md         # 经验积累（持续更新）
```

---

## 二、文档定位

### 1. 核心原则（AI 速览版）

**目标读者**: AI 助手

**特点**:
- 篇幅：1-2 页（约 100-150 行）
- 内容：必须遵守的规则，不含解释
- 格式：表格 + 简短代码示例

**包含内容**:
- 目录结构
- 命名规范
- 导入顺序
- 关键约束（禁止硬编码颜色、信号防循环等）
- 技术栈声明

### 2. 完整版（给人看）

**目标读者**: 开发者

**特点**:
- 篇幅：保持当前规模
- 内容：所有规范细节 + 详细解释
- 格式：当前格式，适当精简冗余

**包含内容**:
- 核心原则（完整版）
- 详细代码示例
- 异常处理规范
- 文档字符串规范
- 主题与样式规范
- 性能优化规范
- 场景配置化规范
- 布局设计规范
- 许可证管理规范

### 3. 开发经验总结

**目标读者**: 开发者（参考用）

**特点**:
- 篇幅：持续积累
- 内容：踩坑记录、解决方案、最佳实践
- 格式：问题 → 分析 → 解决方案

**包含内容**:
- 配色生成功能开发经验
- UI 组件设计经验
- 配置管理最佳实践
- 色轮交互设计
- qfluentwidgets 使用注意事项
- 布局设计最佳实践
- 收藏功能开发经验
- 导入导出功能开发经验
- MessageBox 使用最佳实践
- 配置数据迁移实践
- 内置色彩多段显示经验

---

## 三、内容分配

### 从现有文档提取内容

| 章节 | 核心原则 | 完整版 | 经验总结 |
|------|:--------:|:------:|:--------:|
| 1. 概述 | 简介 | ✅ | - |
| 2. 代码组织规范 | ✅ | ✅ | - |
| 3. 代码编写规范 | ✅ | ✅ | - |
| 4. 基类设计规范 | - | ✅ | - |
| 5. PySide6 开发规范 | ✅ | ✅ | 部分 |
| 6. 颜色处理规范 | - | ✅ | - |
| 7. 图片处理规范 | - | ✅ | - |
| 8. 场景配置化规范 | - | ✅ | - |
| 9. 界面布局规范 | - | ✅ | ✅ |
| 10. 交互设计规范 | - | ✅ | - |
| 11. 版本管理规范 | - | ✅ | - |
| 12. 配置管理规范 | - | ✅ | - |
| 13. 调试规范 | - | ✅ | - |
| 14. 重构规范 | - | ✅ | - |
| 15. 开发经验总结 | - | - | ✅ |
| 16. 开源许可证管理 | - | ✅ | - |

---

## 四、核心原则文档结构

```markdown
# Color Card 开发规范 - 核心原则

## 1. 目录结构
（扁平结构图）

## 2. 命名规范
（表格：类/函数/变量/常量/私有属性）

## 3. 导入顺序
（三段式：标准库 → 第三方 → 项目）

## 4. 关键约束
- 禁止硬编码颜色，使用 utils/theme_colors.py
- 信号同步使用 emit_sync 参数防循环
- 主题切换连接 qconfig.themeChangedFinished
- 异常处理指定具体类型，禁止裸 except

## 5. 技术栈
- Python 3.11+
- PySide6 + qfluentwidgets
- 中文注释

## 6. 代码风格
- 遵循 PEP 8
- 4 空格缩进
- 行长 ≤ 100 字符
```

---

## 五、实施步骤

### 阶段 1：创建核心原则文档

1. 从现有文档提取核心规则
2. 精简为 1-2 页格式
3. 保存为 `开发规范_核心原则.md`

### 阶段 2：创建经验总结文档

1. 提取第 14 章内容
2. 补充布局设计最佳实践
3. 保存为 `开发经验总结.md`

### 阶段 3：精简完整版文档

1. 移除已拆分的内容
2. 保留详细规范和代码示例
3. 更新版本历史

### 阶段 4：更新引用

1. 更新代码审查报告中的引用
2. 在项目 README 中说明文档结构

---

## 六、预期效果

| 指标 | 重构前 | 重构后 |
|------|--------|--------|
| AI 阅读效率 | 低（2236行） | 高（核心原则 100-150 行） |
| 文档定位 | 混杂 | 清晰分离 |
| 维护成本 | 高（改一处影响全局） | 低（各文档独立维护） |
| 经验积累 | 难以持续 | 独立文档，持续更新 |

---

## 七、优先级

| 优先级 | 说明 |
|--------|------|
| **低** | 不影响当前开发，可在架构重构完成后执行 |

**前置条件**:
1. 完成架构重构（目录结构调整）
2. 完成高优先级代码重构任务
3. 项目功能稳定后实施

---

## 八、执行状态

**状态**: ✅ 已完成

**执行日期**: 2026-02-13

**执行结果**:

| 文档 | 行数 | 状态 |
|:---|:---:|:---:|
| `开发规范_核心原则.md` | 184 行 | ✅ 已创建 |
| `开发规范.md` | 964 行 | ✅ 已精简（原 2236 行） |
| `开发经验总结.md` | 467 行 | ✅ 已创建 |

**效果对比**:

| 指标 | 重构前 | 重构后 |
|:---|:---:|:---:|
| AI 阅读效率 | 低（2236行） | 高（核心原则 184 行） |
| 文档定位 | 混杂 | 清晰分离 |
| 维护成本 | 高 | 低 |
| 经验积累 | 难以持续 | 独立文档，持续更新 |

---

## 九、后续维护

### 核心原则
- 仅在有新约束时更新
- 保持精简，不超过 2 页

### 完整版
- 按需更新规范细节
- 保持格式一致

### 经验总结
- 每次解决新问题后添加经验
- 按功能模块分类组织
- 包含问题、分析、解决方案三要素
