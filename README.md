# Color Card

基于 PySide6 和 PyQt-Fluent-Widgets 开发的图片颜色分析工具，用于从图片中提取颜色信息和分析明度分布。

## 功能特性

### 色彩提取
- **图片导入** - 支持 JPG、PNG、BMP、GIF 格式
- **5个可拖动取色点** - 圆形设计，带白色边框，可自由拖动
- **实时颜色提取** - 拖动时实时更新颜色
- **HSB 和 LAB 显示** - 每个色卡显示对应的 HSB 和 LAB 值（双列布局）
- **高分辨率显示** - 使用原始图片实时缩放，保证显示清晰度

### 明度提取
- **9个明度区域** - 将图片按明度分为9个区域（极暗、暗、中暗、次中暗、中灰、次中亮、中亮、亮、极亮）
- **明度直方图** - 实时显示图片明度分布直方图
- **区域高亮显示** - 选中区域在直方图上高亮显示
- **双击提取** - 双击图片区域自动提取对应明度的像素

## 界面布局

### 色彩提取界面
```
┌─────────────────────────────────────┐
│                                     │
│         图片显示区域                 │
│    （5个可拖动圆形取色点）            │
│                                     │
├─────────────────────────────────────┤
│  ┌────┐ ┌────┐ ┌────┐ ┌────┐ ┌────┐│
│  │颜色│ │颜色│ │颜色│ │颜色│ │颜色││
│  │块  │ │块  │ │块  │ │块  │ │块  ││
│  ├────┤ ├────┤ ├────┤ ├────┤ ├────┤│
│  │H:  │ │H:  │ │H:  │ │H:  │ │H:  ││
│  │S:  │ │S:  │ │S:  │ │S:  │ │S:  ││
│  │B:  │ │B:  │ │B:  │ │B:  │ │B:  ││
│  │L:  │ │L:  │ │L:  │ │L:  │ │L:  ││
│  │a:  │ │a:  │ │a:  │ │a:  │ │a:  ││
│  │b:  │ │b:  │ │b:  │ │b:  │ │b:  ││
│  └────┘ └────┘ └────┘ └────┘ └────┘│
└─────────────────────────────────────┘
```

### 明度提取界面
```
┌─────────────────────────────────────┐
│                                     │
│         图片显示区域                 │
│    （9个明度区域覆盖层）              │
│                                     │
├─────────────────────────────────────┤
│         明度分布直方图               │
│    （显示各明度区域的像素分布）        │
└─────────────────────────────────────┘
```

## 使用方法

1. 运行程序
   ```bash
   python main.py
   ```

2. 导入图片
   - 点击图片显示区域的"点击导入图片"提示
   - 或使用菜单栏 文件 → 打开图片 (Ctrl+O)

3. 色彩提取
   - 在"色彩提取"标签页，拖动图片上的5个圆形取色点到任意位置
   - 下方色卡会实时显示对应颜色的 HSB 和 LAB 值

4. 明度提取
   - 切换到"明度提取"标签页
   - 双击图片任意区域，自动提取该明度对应的像素
   - 查看下方直方图了解明度分布

## 文件结构

```
.
├── main.py                    # 程序入口
├── color_utils.py             # 颜色转换工具（RGB ↔ HSB/LAB）
├── README.md                  # 项目说明文档
└── widgets/
    ├── __init__.py
    ├── main_window.py         # 主窗口
    ├── color_card.py          # 色彩提取界面
    ├── color_picker.py        # 可拖动取色点组件
    ├── image_canvas.py        # 图片显示画布（含取色点管理）
    ├── luminance_canvas.py    # 明度提取画布
    ├── luminance_card.py      # 明度卡片组件
    ├── luminance_histogram.py # 明度直方图
    └── histogram_widget.py    # 直方图显示组件
```

## 技术细节

### 颜色空间转换

- **HSB** (Hue, Saturation, Brightness)
  - H: 色相 (0-360°)
  - S: 饱和度 (0-100%)
  - B: 亮度 (0-100%)

- **LAB** (Lightness, a, b)
  - L: 明度
  - a: 绿-红轴
  - b: 蓝-黄轴

### 明度区域划分

图片按明度值（0-255）分为9个区域：
- 极暗: 0-28
- 暗: 28-56
- 中暗: 56-85
- 次中暗: 85-113
- 中灰: 113-141
- 次中亮: 141-170
- 中亮: 170-198
- 亮: 198-227
- 极亮: 227-255

### 图片显示优化

- 保留原始高分辨率图片
- 绘制时实时缩放显示
- 取色时映射到原始图片坐标
- 避免多次缩放导致的画质损失

## 依赖

- Python 3.x
- PySide6
- PyQt-Fluent-Widgets
- numpy
- scikit-image

## 快捷键

- `Ctrl + O` - 打开图片
- `Ctrl + Q` - 退出程序

## 版本历史

### v1.1.0

- 新增明度提取功能
- 新增明度直方图显示
- 优化界面布局
- 使用 PyQt-Fluent-Widgets 美化界面

### v1.0.0

- 基础功能实现
- 5个可拖动取色点
- HSB/LAB 双列显示
- 高分辨率图片显示优化
- 简洁的导入界面
